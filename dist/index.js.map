{"version":3,"sources":["webpack://MonacoEditorCodeReview/webpack/bootstrap","webpack://MonacoEditorCodeReview/./node_modules/uuid/lib/bytesToUuid.js","webpack://MonacoEditorCodeReview/./node_modules/uuid/lib/rng-browser.js","webpack://MonacoEditorCodeReview/./node_modules/uuid/v4.js","webpack://MonacoEditorCodeReview/./src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([bth[buf[i++]], bth[buf[i++]], \n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]]]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","import * as uuid from \"uuid/v4\";\nimport * as monacoEditor from \"monaco-editor\";\n\n\n\ninterface MonacoWindow {\n    monaco: any;\n}\n\nconst monacoWindow = (window as any) as MonacoWindow;\n\nexport interface ReviewComment {\n    id?: string;\n    parentId?: string;\n    author: string;\n    dt: Date | string;\n    lineNumber: number;\n    text: string;\n    selection?: CodeSelection;\n    status?: ReviewCommentStatus;\n}\n\nexport enum ReviewCommentStatus {\n    active = 1,\n    deleted = 2\n}\n\ninterface CodeSelection {\n    startColumn: number,\n    endColumn: number,\n    startLineNumber: number,\n    endLineNumber: number\n}\n\nclass ReviewCommentState {\n    viewZoneId: string;\n    renderStatus: ReviewCommentRenderState;\n    numberOfLines: number;\n\n    constructor(numberOfLines: number) {\n        this.renderStatus = ReviewCommentRenderState.normal;\n        this.viewZoneId = null;\n        this.numberOfLines = numberOfLines;\n    }\n}\n\nexport function createReviewManager(editor: any, currentUser: string, comments?: ReviewComment[], onChange?: OnCommentsChanged, config?: ReviewManagerConfig): ReviewManager {\n    //For Debug: (window as any).editor = editor;\n    const rm = new ReviewManager(editor, currentUser, onChange, config);\n    rm.load(comments || []);\n    return rm;\n}\n\n\ninterface ReviewCommentIterItem {\n    depth: number;\n    comment: ReviewComment,\n    viewState: ReviewCommentState\n}\n\ninterface OnCommentsChanged {\n    (comments: ReviewComment[]): void\n}\n\nexport interface ReviewManagerConfig {\n    editButtonEnableRemove?: boolean;\n    commentIndent?: number;\n    commentIndentOffset?: number;\n    editButtonAddText?: string;\n    editButtonRemoveText?: string;\n    editButtonOffset?: string;\n    reviewCommentIconSelect?: string;\n    reviewCommentIconActive?: string;\n    showInRuler?: boolean\n    formatDate?: { (dt: Date): string }\n}\n\ninterface ReviewManagerConfigPrivate {\n    rulerMarkerColor: any;\n    rulerMarkerDarkColor: any;\n    editButtonEnableRemove: boolean;\n    commentIndent: number;\n    commentIndentOffset: number;\n    editButtonAddText: string;\n    editButtonRemoveText: string;\n    editButtonOffset: string;\n    showInRuler: boolean;\n    formatDate?: { (dt: Date | string): string };\n    showAddCommentGlyph: boolean\n}\n\n\nconst defaultReviewManagerConfig: ReviewManagerConfigPrivate = {\n    editButtonOffset: '-10px',\n    editButtonAddText: 'Reply',\n    editButtonRemoveText: 'Remove',\n    editButtonEnableRemove: true,\n    commentIndent: 20,\n    commentIndentOffset: 20,\n    showInRuler: true,\n    rulerMarkerColor: 'darkorange',\n    rulerMarkerDarkColor: 'darkorange',\n    formatDate: null,\n    showAddCommentGlyph: true,\n};\n\nconst CONTROL_ATTR_NAME = 'ReviewManagerControl';\n\nclass ReviewManager {\n    currentUser: string;\n    editor: monacoEditor.editor.IStandaloneCodeEditor;\n    editorConfig: monacoEditor.editor.InternalEditorOptions;\n    comments: ReviewComment[];\n    commentState: { [reviewCommentId: string]: ReviewCommentState };\n\n    activeComment?: ReviewComment;\n    widgetInlineToolbar: any;\n    widgetInlineCommentEditor: any;\n    onChange: OnCommentsChanged;\n    editorMode: EditorMode;\n    config: ReviewManagerConfigPrivate;\n\n    textarea: HTMLTextAreaElement;\n    currentLineDecorations: string[];\n    currentCommentDecorations: string[];\n    currentLineDecorationLineNumber?: number;\n\n\n    constructor(editor: any, currentUser: string, onChange: OnCommentsChanged, config?: ReviewManagerConfig) {\n        this.currentUser = currentUser;\n        this.editor = editor;\n        this.activeComment = null;\n        this.comments = [];\n        this.commentState = {};\n        this.widgetInlineToolbar = null;\n        this.widgetInlineCommentEditor = null;\n        this.onChange = onChange;\n        this.editorMode = EditorMode.toolbar;\n        this.config = { ...defaultReviewManagerConfig, ...(config || {}) };\n        this.currentLineDecorations = [];\n        this.currentCommentDecorations = []\n        this.currentLineDecorationLineNumber = null;\n\n        this.addActions();\n        this.createInlineToolbarWidget();\n        this.createInlineEditorWidget();\n\n        this.editor.onMouseDown(this.handleMouseDown.bind(this));\n\n        this.editorConfig = this.editor.getConfiguration();\n        this.editor.onDidChangeConfiguration(() => this.editorConfig = this.editor.getConfiguration());\n\n        if (this.config.showAddCommentGlyph) {\n            this.editor.onMouseMove(this.handleMouseMove.bind(this));\n        }\n    }\n\n    load(comments: ReviewComment[]): void {\n        this.editor.changeViewZones((changeAccessor) => {\n            // Remove all the existing comments     \n            for (const viewState of Object.values(this.commentState)) {\n                if (viewState.viewZoneId !== null) {\n                    changeAccessor.removeZone(viewState.viewZoneId);\n                }\n            }\n\n            this.comments = comments || [];\n            this.commentState = {};\n\n            // Check all comments that they have unique and present id's\n            for (const comment of comments) {\n                const originalId = comment.id;\n                let changedId = false;\n\n                while (!comment.id || this.commentState[comment.id]) {\n                    comment.id = uuid();\n                    changedId = true;\n                }\n\n                if (changedId) {\n                    console.warn('Comment.Id Assigned: ', originalId, ' changed to to ', comment.id, ' due to collision');\n                }\n\n                this.commentState[comment.id] = new ReviewCommentState(this.calculateNumberOfLines(comment.text));\n            }\n\n            this.refreshComments();\n\n            console.debug('Comments Loaded: ', this.comments.length);\n        })\n    }\n\n    calculateNumberOfLines(text: string): number {\n        return text.split(/\\r*\\n/).length;\n    }\n\n    getThemedColor(name: string): string {\n        // editor.background: e {rgba: e}\n        // editor.foreground: e {rgba: e}\n        // editor.inactiveSelectionBackground: e {rgba: e}\n        // editor.selectionHighlightBackground: e {rgba: e}\n        // editorIndentGuide.activeBackground: e {rgba: e}\n        // editorIndentGuide.background: e {rgba: e}\n        return (this.editor as any)._themeService.getTheme().getColor(name);\n    }\n\n    createInlineEditButtonsElement() {\n        var root = document.createElement('div') as HTMLDivElement;\n        root.className = 'editButtonsContainer'\n        root.style.marginLeft = this.config.editButtonOffset;\n\n        const add = document.createElement('span') as HTMLSpanElement;\n        add.innerText = this.config.editButtonAddText;\n        add.className = 'editButton add'\n        add.setAttribute(CONTROL_ATTR_NAME, '');\n        add.onclick = () => this.setEditorMode(EditorMode.editComment);\n        root.appendChild(add);\n\n        if (this.config.editButtonEnableRemove) {\n            const spacer = document.createElement('div') as HTMLDivElement;\n            spacer.innerText = ' '\n            root.appendChild(spacer);\n\n            const remove = document.createElement('span') as HTMLSpanElement;\n            remove.setAttribute(CONTROL_ATTR_NAME, '');\n            remove.innerText = this.config.editButtonRemoveText;\n            remove.className = 'editButton remove'\n            remove.onclick = () => this.removeComment(this.activeComment);\n            root.appendChild(remove);\n        }\n\n\n        return root;\n    }\n\n    handleCancel() {\n        this.setEditorMode(EditorMode.toolbar);\n        this.editor.focus();\n    }\n\n    handleSave() {\n        this.setEditorMode(EditorMode.toolbar);\n        const lineNumber = this.activeComment ? this.activeComment.lineNumber : this.editor.getSelection().endLineNumber;\n        const text = this.textarea.value;\n        const selection = this.activeComment ? null : this.editor.getSelection() as CodeSelection;\n        this.addComment(lineNumber, text, selection);\n        this.editor.focus();\n    }\n\n    handleTextAreaKeyDown(e: KeyboardEvent) {\n        if (e.code === \"Escape\") {\n            this.handleCancel();\n        } else if (e.code === \"Enter\" && e.ctrlKey) {\n            this.handleSave();\n        }\n    }\n\n    createInlineEditorElement() {\n        var root = document.createElement('span') as HTMLSpanElement;\n        root.className = \"reviewCommentEdit\"\n\n        const textarea = document.createElement('textarea') as HTMLTextAreaElement;\n        textarea.setAttribute(CONTROL_ATTR_NAME, '');\n        textarea.className = \"reviewCommentText\";\n        textarea.innerText = '';\n        textarea.name = 'text';\n        textarea.onkeydown = this.handleTextAreaKeyDown.bind(this);\n\n        const save = document.createElement('button') as HTMLButtonElement;\n        save.setAttribute(CONTROL_ATTR_NAME, '');\n        save.className = \"reviewCommentSave\";\n        save.innerText = 'Save';\n        save.onclick = this.handleSave.bind(this);\n\n        const cancel = document.createElement('button') as HTMLButtonElement;\n        cancel.setAttribute(CONTROL_ATTR_NAME, '');\n        cancel.className = \"reviewCommentCancel\";\n        cancel.innerText = 'Cancel';\n        cancel.onclick = this.handleCancel.bind(this);\n\n        root.appendChild(textarea);\n        root.appendChild(save);\n        root.appendChild(cancel);\n\n        this.textarea = textarea;\n        return root\n    }\n\n    createInlineToolbarWidget() {\n        const buttonsElement = this.createInlineEditButtonsElement();\n\n        this.widgetInlineToolbar = {\n            allowEditorOverflow: true,\n            getId: () => {\n                return 'widgetInlineToolbar';\n            },\n            getDomNode: () => {\n                return buttonsElement;\n            },\n            getPosition: () => {\n                if (this.activeComment && this.editorMode == EditorMode.toolbar) {\n                    return {\n                        position: {\n                            lineNumber: this.activeComment.lineNumber + 1,\n                        },\n                        preference: [monacoWindow.monaco.editor.ContentWidgetPositionPreference.BELOW]\n                    }\n                }\n            }\n        };\n\n        this.editor.addContentWidget(this.widgetInlineToolbar);\n    }\n\n    createInlineEditorWidget() {\n        const editorElement = this.createInlineEditorElement();\n\n        this.widgetInlineCommentEditor = {\n            allowEditorOverflow: true,\n            getId: () => {\n                return 'widgetInlineEditor';\n            },\n            getDomNode: () => {\n                return editorElement;\n            },\n            getPosition: () => {\n                if (this.editorMode == EditorMode.editComment) {\n                    return {\n                        position: {\n                            // We are using negative marginTop to shift it above the line to the previous\n                            lineNumber: this.activeComment ? this.activeComment.lineNumber + 1 : this.editor.getPosition().lineNumber\n                        },\n                        preference: [monacoWindow.monaco.editor.ContentWidgetPositionPreference.BELOW]\n                    }\n                }\n            }\n        };\n\n        this.editor.addContentWidget(this.widgetInlineCommentEditor);\n    }\n\n    setActiveComment(comment: ReviewComment) {\n        console.debug('setActiveComment', comment);\n\n        const lineNumbersToMakeDirty = [];\n        if (this.activeComment && (!comment || this.activeComment.lineNumber !== comment.lineNumber)) {\n            lineNumbersToMakeDirty.push(this.activeComment.lineNumber);\n        }\n        if (comment) {\n            lineNumbersToMakeDirty.push(comment.lineNumber);\n        }\n\n        this.activeComment = comment;\n        if (lineNumbersToMakeDirty.length > 0) {\n            this.filterAndMapComments(lineNumbersToMakeDirty, (comment) => {\n                this.commentState[comment.id].renderStatus = ReviewCommentRenderState.dirty;\n            });\n        }\n    }\n\n    layoutInlineToolbar() {\n        const toolbarRoot = this.widgetInlineToolbar.getDomNode() as HTMLElement;\n\n        if (this.activeComment) {\n            toolbarRoot.style.marginTop = `-${this.calculateMarginTopOffset(2)}px`;\n        }\n        toolbarRoot.style.backgroundColor = this.getThemedColor(\"editor.background\");\n        this.editor.layoutContentWidget(this.widgetInlineToolbar);\n    }\n\n    filterAndMapComments(lineNumbers: number[], fn: { (comment: ReviewComment): void }) {\n        for (const comment of this.comments) {\n            if (lineNumbers.indexOf(comment.lineNumber) > -1) {\n                fn(comment);\n            }\n        }\n    }\n\n    handleMouseMove(ev) {\n        if (ev.target && ev.target.position && ev.target.position.lineNumber) {\n            this.currentLineDecorationLineNumber = ev.target.position.lineNumber;\n            this.currentLineDecorations = this.editor.deltaDecorations(this.currentLineDecorations, [\n                {\n                    range: new monacoWindow.monaco.Range(ev.target.position.lineNumber, 0, ev.target.position.lineNumber, 0),\n                    options: {\n                        glyphMarginClassName: 'activeLineGlyphmyMarginClass',\n                        isWholeLine: true\n                    }\n                }\n            ]);\n        }\n    }\n\n    handleMouseDown(ev: { target: { element: { className: string, hasAttribute: { (string): boolean } }, detail: any } }) {\n        // Not ideal - but couldn't figure out a different way to identify the glyph event        \n        if (ev.target.element.className && ev.target.element.className.indexOf('activeLineGlyphmyMarginClass') > -1) {\n            this.editor.setPosition({ lineNumber: this.currentLineDecorationLineNumber, column: 1 });\n            this.setEditorMode(EditorMode.editComment);\n        } else if (!ev.target.element.hasAttribute(CONTROL_ATTR_NAME)) {\n            let activeComment: ReviewComment = null;\n\n            if (ev.target.detail && ev.target.detail.viewZoneId !== null) {\n                for (const comment of this.comments) {\n                    const viewState = this.commentState[comment.id];\n                    if (viewState.viewZoneId == ev.target.detail.viewZoneId) {\n                        activeComment = comment;\n                        break;\n                    }\n                }\n            }\n            this.setActiveComment(activeComment);\n            this.refreshComments();\n            this.setEditorMode(EditorMode.toolbar);\n        }\n    }\n\n    private calculateMarginTopOffset(extraOffsetLines: number = 1): number {\n        let idx = 0;\n        let count = 0;\n        let marginTop: number = 0;\n        const lineHeight = this.editorConfig.fontInfo.lineHeight;\n\n        if (this.activeComment) {\n            for (var item of this.iterateComments()) {\n                if (item.comment.lineNumber == this.activeComment.lineNumber) {\n                    count++;\n                }\n\n                if (item.comment == this.activeComment) {\n                    idx = count + 0;\n                }\n            }\n            marginTop = ((extraOffsetLines + count - idx) * lineHeight);\n        }\n\n        return marginTop;\n    }\n\n    setEditorMode(mode: EditorMode) {\n        console.debug('setEditorMode', this.activeComment);\n\n        this.editorMode = mode;\n\n        const editorRoot = this.widgetInlineCommentEditor.getDomNode() as HTMLElement;\n        editorRoot.style.marginTop = `-${this.calculateMarginTopOffset()}px`;\n\n        this.layoutInlineToolbar();\n        this.editor.layoutContentWidget(this.widgetInlineCommentEditor);\n\n        if (mode == EditorMode.editComment) {\n            this.textarea.value = \"\";\n            //HACK - because the event in monaco doesn't have preventdefault which means editor takes focus back...                        \n            setTimeout(() => this.textarea.focus(), 100);\n        }\n    }\n\n    addComment(lineNumber: number, text: string, selection?: CodeSelection): ReviewComment {\n        const ln = this.activeComment ? this.activeComment.lineNumber : lineNumber;\n        const comment: ReviewComment = {\n            id: uuid(),\n            lineNumber: ln,\n            author: this.currentUser,\n            dt: new Date(),\n            text: text,\n            status: ReviewCommentStatus.active,\n            selection: selection,\n            parentId: this.activeComment ? this.activeComment.id : null\n        };\n\n        this.commentState[comment.id] = new ReviewCommentState(this.calculateNumberOfLines(text));\n        this.comments.push(comment);\n\n        this.filterAndMapComments([ln], (comment) => {\n            this.commentState[comment.id].renderStatus = ReviewCommentRenderState.dirty;\n        });\n\n        this.refreshComments()\n        this.layoutInlineToolbar();\n\n        if (this.onChange) {\n            this.onChange(this.comments);\n        }\n\n        return comment;\n    }\n\n    private recurseComments(allComments: { [key: string]: ReviewComment }, filterFn: { (c: ReviewComment): boolean }, depth: number, results: ReviewCommentIterItem[]) {\n        const comments = Object.values(allComments).filter(filterFn).sort((a, b) => a.dt > b.dt ? 1 : -1);\n        for (const comment of comments) {\n            delete allComments[comment.id];\n\n            results.push({\n                depth,\n                comment,\n                viewState: this.commentState[comment.id]\n            });\n            this.recurseComments(allComments,\n                (x) => x.parentId === comment.id,\n                depth + 1,\n                results);\n        }\n    }\n\n    private iterateComments(filterFn?: { (c: ReviewComment): boolean }) {\n        if (!filterFn) {\n            filterFn = (c: ReviewComment) => !c.parentId;\n        }\n        const tmpComments: { [key: string]: ReviewComment } = (this.comments).reduce((obj, item) => {\n            obj[item.id] = item\n            return obj\n        }, {});\n\n        const results: ReviewCommentIterItem[] = [];\n        this.recurseComments(tmpComments, filterFn, 0, results);\n        return results;\n    }\n\n    removeComment(comment: ReviewComment) {\n        for (const item of this.iterateComments((c) => c.id === comment.id)) {\n            item.comment.status = ReviewCommentStatus.deleted;\n        }\n        if (this.activeComment == comment) {\n            this.setActiveComment(null);\n            this.layoutInlineToolbar();\n        }\n\n        this.refreshComments();\n        if (this.onChange) {\n            this.onChange(this.comments);\n        }\n    }\n\n    private formatDate(dt: Date | string) {\n        if (this.config.formatDate) {\n            return this.config.formatDate(dt)\n        } else if (dt instanceof Date) {\n            return dt.toISOString();\n        } else {\n            return dt;\n        }\n    }\n\n    refreshComments() {\n        this.editor.changeViewZones((changeAccessor: {\n            addZone: { (zone: { afterLineNumber: number, heightInLines: number, domNode: HTMLElement, suppressMouseDown: boolean }): string },\n            removeZone: { (id: string): void }\n        }) => {\n            const lineNumbers: { [key: number]: CodeSelection } = {};\n\n            for (const item of this.iterateComments()) {\n                if (item.comment.status && item.comment.status === ReviewCommentStatus.deleted) {\n                    console.debug('Zone.Delete', item.comment.id);\n\n                    changeAccessor.removeZone(item.viewState.viewZoneId);\n                    continue;\n                }\n\n                if (item.viewState.renderStatus === ReviewCommentRenderState.hidden) {\n                    console.debug('Zone.Hidden', item.comment.id);\n\n                    changeAccessor.removeZone(item.viewState.viewZoneId);\n                    item.viewState.viewZoneId = null;\n\n                    continue;\n                }\n\n                if (item.viewState.renderStatus === ReviewCommentRenderState.dirty) {\n                    console.debug('Zone.Dirty', item.comment.id);\n\n                    changeAccessor.removeZone(item.viewState.viewZoneId);\n                    item.viewState.viewZoneId = null;\n                    item.viewState.renderStatus = ReviewCommentRenderState.normal;\n                }\n\n                if (!lineNumbers[item.comment.lineNumber]) {\n                    lineNumbers[item.comment.lineNumber] = item.comment.selection;\n                }\n\n                if (item.viewState.viewZoneId == null) {\n                    console.debug('Zone.Create', item.comment.id);\n\n                    const isActive = this.activeComment == item.comment;\n\n                    const domNode = document.createElement('span') as HTMLSpanElement;\n                    domNode.style.marginLeft = (this.config.commentIndent * (item.depth + 1)) + this.config.commentIndentOffset + \"px\";\n                    domNode.style.backgroundColor = this.getThemedColor(\"editor.selectionHighlightBackground\");\n                    domNode.className = `reviewComment ${isActive ? 'active' : ' inactive'}`;\n\n                    const author = document.createElement('span') as HTMLSpanElement;\n                    author.className = 'reviewComment author'\n                    author.innerText = `${item.comment.author || ' '} at `;\n\n                    const dt = document.createElement('span') as HTMLSpanElement;\n                    dt.className = 'reviewComment dt'\n                    dt.innerText = this.formatDate(item.comment.dt);\n\n                    const text = document.createElement('span') as HTMLSpanElement;\n                    text.className = 'reviewComment text'\n                    text.innerText = `${item.comment.text} by `;\n\n                    domNode.appendChild(text);\n                    domNode.appendChild(author);\n                    domNode.appendChild(dt);\n\n                    item.viewState.viewZoneId = changeAccessor.addZone({\n                        afterLineNumber: item.comment.lineNumber,\n                        heightInLines: item.viewState.numberOfLines,\n                        domNode: domNode,\n                        suppressMouseDown: true // This stops focus being lost the editor - meaning keyboard shortcuts keeps working\n                    });\n                }\n            }\n\n            if (this.config.showInRuler) {\n                const decorators = [];\n                for (const [ln, selection] of Object.entries(lineNumbers)) {\n\n                    decorators.push({\n                        range: new monacoWindow.monaco.Range(ln, 0, ln, 0),\n                        options: {\n                            isWholeLine: true,\n                            overviewRuler: {\n                                color: this.config.rulerMarkerColor,\n                                darkColor: this.config.rulerMarkerDarkColor,\n                                position: 1\n                            }\n                        }\n                    })\n\n                    if (selection) {\n                        decorators.push({\n                            range: new monacoWindow.monaco.Range(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn),\n                            options: {\n                                className: 'reviewComment selection',\n                            }\n                        })\n                    }\n                }\n\n                this.currentCommentDecorations = this.editor.deltaDecorations(this.currentCommentDecorations, decorators);\n            }\n        });\n    }\n\n    addActions() {\n        this.editor.addAction({\n            id: 'my-unique-id-add',\n            label: 'Add Comment',\n            keybindings: [\n                monacoWindow.monaco.KeyMod.CtrlCmd | monacoWindow.monaco.KeyCode.F10,\n            ],\n            precondition: null,\n            keybindingContext: null,\n            contextMenuGroupId: 'navigation',\n            contextMenuOrder: 0,\n\n            run: () => {\n                this.setEditorMode(EditorMode.editComment);\n            }\n        });\n\n        this.editor.addAction({\n            id: 'my-unique-id-next',\n            label: 'Next Comment',\n            keybindings: [\n                monacoWindow.monaco.KeyMod.CtrlCmd | monacoWindow.monaco.KeyCode.F12,\n            ],\n            precondition: null,\n            keybindingContext: null,\n            contextMenuGroupId: 'navigation',\n            contextMenuOrder: 0.1,\n\n            run: () => {\n                this.navigateToComment(NavigationDirection.next);\n            }\n        });\n\n        this.editor.addAction({\n            id: 'my-unique-id-prev',\n            label: 'Prev Comment',\n            keybindings: [\n                monacoWindow.monaco.KeyMod.CtrlCmd | monacoWindow.monaco.KeyCode.F11,\n            ],\n            precondition: null,\n            keybindingContext: null,\n            contextMenuGroupId: 'navigation',\n            contextMenuOrder: 0.1,\n\n            run: () => {\n                this.navigateToComment(NavigationDirection.prev);\n            }\n        });\n    }\n\n    navigateToComment(direction: NavigationDirection) {\n        let currentLine = 0;\n        if (this.activeComment) {\n            currentLine = this.activeComment.lineNumber;\n        } else {\n            currentLine = this.editor.getPosition().lineNumber;\n        }\n\n        const comments = this.comments.filter((c) => {\n            if (c.status !== ReviewCommentStatus.deleted && !c.parentId) {\n                if (direction === NavigationDirection.next) {\n                    return c.lineNumber > currentLine;\n                } else if (direction === NavigationDirection.prev) {\n                    return c.lineNumber < currentLine;\n                }\n            }\n        });\n\n        if (comments.length) {\n            comments.sort((a, b) => {\n                if (direction === NavigationDirection.next) {\n                    return a.lineNumber - b.lineNumber;\n                } else if (direction === NavigationDirection.prev) {\n                    return b.lineNumber - a.lineNumber;\n                }\n            });\n\n            const comment = comments[0];\n            this.setActiveComment(comment)\n            this.refreshComments();\n            this.layoutInlineToolbar();\n            this.editor.revealLineInCenter(comment.lineNumber);\n        }\n    }\n}\n\n\nenum NavigationDirection {\n    next = 1,\n    prev = 2\n}\n\nenum EditorMode {\n    editComment = 1,\n    toolbar = 2\n}\n\nenum ReviewCommentRenderState {\n    dirty = 1,\n    hidden = 2,\n    normal = 3\n}"],"sourceRoot":""}